import*as t from"node:fs";import*as e from"node:path";import{execSync as r}from"child_process";import n,{promises as o,createReadStream as i}from"fs";import{resolve as a,join as s,dirname as c}from"path";import{createHash as u}from"crypto";import{homedir as f}from"os";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function l(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))}function h(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var p,d;var y,v=function(){if(d)return p;function t(t){return"number"==typeof t||(!!/^0x[0-9a-f]+$/i.test(t)||/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(t))}function e(t,e){return"constructor"===e&&"function"==typeof t[e]||"__proto__"===e}return d=1,p=function(r,n){n||(n={});var o={bools:{},strings:{},unknownFn:null};"function"==typeof n.unknown&&(o.unknownFn=n.unknown),"boolean"==typeof n.boolean&&n.boolean?o.allBools=!0:[].concat(n.boolean).filter(Boolean).forEach((function(t){o.bools[t]=!0}));var i={};function a(t){return i[t].some((function(t){return o.bools[t]}))}Object.keys(n.alias||{}).forEach((function(t){i[t]=[].concat(n.alias[t]),i[t].forEach((function(e){i[e]=[t].concat(i[t].filter((function(t){return e!==t})))}))})),[].concat(n.string).filter(Boolean).forEach((function(t){o.strings[t]=!0,i[t]&&[].concat(i[t]).forEach((function(t){o.strings[t]=!0}))}));var s=n.default||{},c={_:[]};function u(t,r,n){for(var i=t,a=0;a<r.length-1;a++){var s=r[a];if(e(i,s))return;void 0===i[s]&&(i[s]={}),i[s]!==Object.prototype&&i[s]!==Number.prototype&&i[s]!==String.prototype||(i[s]={}),i[s]===Array.prototype&&(i[s]=[]),i=i[s]}var c=r[r.length-1];e(i,c)||(i!==Object.prototype&&i!==Number.prototype&&i!==String.prototype||(i={}),i===Array.prototype&&(i=[]),void 0===i[c]||o.bools[c]||"boolean"==typeof i[c]?i[c]=n:Array.isArray(i[c])?i[c].push(n):i[c]=[i[c],n])}function f(e,r,n){if(!n||!o.unknownFn||function(t,e){return o.allBools&&/^--[^=]+$/.test(e)||o.strings[t]||o.bools[t]||i[t]}(e,n)||!1!==o.unknownFn(n)){var a=!o.strings[e]&&t(r)?Number(r):r;u(c,e.split("."),a),(i[e]||[]).forEach((function(t){u(c,t.split("."),a)}))}}Object.keys(o.bools).forEach((function(t){f(t,void 0!==s[t]&&s[t])}));var l=[];-1!==r.indexOf("--")&&(l=r.slice(r.indexOf("--")+1),r=r.slice(0,r.indexOf("--")));for(var h=0;h<r.length;h++){var p,d,y=r[h];if(/^--.+=/.test(y)){var v=y.match(/^--([^=]+)=([\s\S]*)$/);p=v[1];var b=v[2];o.bools[p]&&(b="false"!==b),f(p,b,y)}else if(/^--no-.+/.test(y))f(p=y.match(/^--no-(.+)/)[1],!1,y);else if(/^--.+/.test(y))p=y.match(/^--(.+)/)[1],void 0===(d=r[h+1])||/^(-|--)[^-]/.test(d)||o.bools[p]||o.allBools||i[p]&&a(p)?/^(true|false)$/.test(d)?(f(p,"true"===d,y),h+=1):f(p,!o.strings[p]||"",y):(f(p,d,y),h+=1);else if(/^-[^-]+/.test(y)){for(var g=y.slice(1,-1).split(""),m=!1,_=0;_<g.length;_++)if("-"!==(d=y.slice(_+2))){if(/[A-Za-z]/.test(g[_])&&"="===d[0]){f(g[_],d.slice(1),y),m=!0;break}if(/[A-Za-z]/.test(g[_])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(d)){f(g[_],d,y),m=!0;break}if(g[_+1]&&g[_+1].match(/\W/)){f(g[_],y.slice(_+2),y),m=!0;break}f(g[_],!o.strings[g[_]]||"",y)}else f(g[_],d,y);p=y.slice(-1)[0],m||"-"===p||(!r[h+1]||/^(-|--)[^-]/.test(r[h+1])||o.bools[p]||i[p]&&a(p)?r[h+1]&&/^(true|false)$/.test(r[h+1])?(f(p,"true"===r[h+1],y),h+=1):f(p,!o.strings[p]||"",y):(f(p,r[h+1],y),h+=1))}else if(o.unknownFn&&!1===o.unknownFn(y)||c._.push(o.strings._||!t(y)?y:Number(y)),n.stopEarly){c._.push.apply(c._,r.slice(h+1));break}}return Object.keys(s).forEach((function(t){(function(t,e){var r=t;return e.slice(0,-1).forEach((function(t){r=r[t]||{}})),e[e.length-1]in r})(c,t.split("."))||(u(c,t.split("."),s[t]),(i[t]||[]).forEach((function(e){u(c,e.split("."),s[t])})))})),n["--"]?c["--"]=l.slice():l.forEach((function(t){c._.push(t)})),c},p}(),b=h(v),g={exports:{}};var m=h((y||(y=1,function(t){!function(){function e(t){var e=t.slice(11),r=null,n=null;switch(e.indexOf('"')){case-1:r=(a=e.split(" "))[0].slice(2),n=a[1].slice(2);break;case 0:var o=e.indexOf('"',2);r=e.slice(3,o);var i=e.indexOf('"',o+1);n=i<0?e.slice(o+4):e.slice(i+3,-1);break;default:var a;r=(a=e.split(" "))[0].slice(2),n=a[1].slice(3,-1)}return{oldPath:r,newPath:n}}var r={parse:function(t){for(var r,n,o,i,a,s=[],c=2,u=t.split("\n"),f=u.length,l=0;l<f;){var h=u[l];if(0===h.indexOf("diff --git")){r={hunks:[],oldEndingNewLine:!0,newEndingNewLine:!0,oldPath:(a=e(h)).oldPath,newPath:a.newPath},s.push(r);var p,d=null;t:for(;p=u[++l];){var y=p.indexOf(" "),v=y>-1?p.slice(0,y):v;switch(v){case"diff":l--;break t;case"deleted":case"new":var b=p.slice(y+1);0===b.indexOf("file mode")&&(r["new"===v?"newMode":"oldMode"]=b.slice(10));break;case"similarity":r.similarity=parseInt(p.split(" ")[2],10);break;case"index":var g=p.slice(y+1).split(" "),m=g[0].split("..");r.oldRevision=m[0],r.newRevision=m[1],g[1]&&(r.oldMode=r.newMode=g[1]);break;case"copy":case"rename":var _=p.slice(y+1);0===_.indexOf("from")?r.oldPath=_.slice(5):r.newPath=_.slice(3),d=v;break;case"---":var w=p.slice(y+1),j=u[++l].slice(4);"/dev/null"===w?(j=j.slice(2),d="add"):"/dev/null"===j?(w=w.slice(2),d="delete"):(d="modify",w=w.slice(2),j=j.slice(2)),w&&(r.oldPath=w),j&&(r.newPath=j),c=5;break t}}r.type=d||"modify"}else if(0===h.indexOf("Binary"))r.isBinary=!0,r.type=h.indexOf("/dev/null and")>=0?"add":h.indexOf("and /dev/null")>=0?"delete":"modify",c=2,r=null;else if(5===c)if(0===h.indexOf("@@")){var O=/^@@\s+-([0-9]+)(,([0-9]+))?\s+\+([0-9]+)(,([0-9]+))?/.exec(h);n={content:h,oldStart:O[1]-0,newStart:O[4]-0,oldLines:O[3]-0||1,newLines:O[6]-0||1,changes:[]},r.hunks.push(n),o=n.oldStart,i=n.newStart}else{var E=h.slice(0,1),A={content:h.slice(1)};switch(E){case"+":A.type="insert",A.isInsert=!0,A.lineNumber=i,i++;break;case"-":A.type="delete",A.isDelete=!0,A.lineNumber=o,o++;break;case" ":A.type="normal",A.isNormal=!0,A.oldLineNumber=o,A.newLineNumber=i,o++,i++;break;case"\\":var x=n.changes[n.changes.length-1];x.isDelete||(r.newEndingNewLine=!1),x.isInsert||(r.oldEndingNewLine=!1)}A.type&&n.changes.push(A)}l++}return s}};t.exports=r}()}(g)),g.exports)),_="object"==typeof global&&global&&global.Object===Object&&global,w="object"==typeof self&&self&&self.Object===Object&&self,j=_||w||Function("return this")(),O=j.Symbol,E=Object.prototype,A=E.hasOwnProperty,x=E.toString,T=O?O.toStringTag:void 0;var P=Object.prototype.toString;var S=O?O.toStringTag:void 0;function I(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":S&&S in Object(t)?function(t){var e=A.call(t,T),r=t[T];try{t[T]=void 0;var n=!0}catch(t){}var o=x.call(t);return n&&(e?t[T]=r:delete t[T]),o}(t):function(t){return P.call(t)}(t)}function B(t){return null!=t&&"object"==typeof t}function N(t){return"symbol"==typeof t||B(t)&&"[object Symbol]"==I(t)}function $(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var k=Array.isArray,R=O?O.prototype:void 0,L=R?R.toString:void 0;function D(t){if("string"==typeof t)return t;if(k(t))return $(t,D)+"";if(N(t))return L?L.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}var M=/\s/;var F=/^\s+/;function U(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&M.test(t.charAt(e)););return e}(t)+1).replace(F,""):t}function C(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var H=/^[-+]0x[0-9a-f]+$/i,z=/^0b[01]+$/i,q=/^0o[0-7]+$/i,G=parseInt;var W=1/0;function J(t){return t?(t=function(t){if("number"==typeof t)return t;if(N(t))return NaN;if(C(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=C(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=U(t);var r=z.test(t);return r||q.test(t)?G(t.slice(2),r?2:8):H.test(t)?NaN:+t}(t))===W||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function V(t){var e=J(t),r=e%1;return e==e?r?e-r:e:0}function Y(t){return t}function X(t){if(!C(t))return!1;var e=I(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}var Z,K=j["__core-js_shared__"],Q=(Z=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||""))?"Symbol(src)_1."+Z:"";var tt=Function.prototype.toString;function et(t){if(null!=t){try{return tt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var rt=/^\[object .+?Constructor\]$/,nt=Function.prototype,ot=Object.prototype,it=nt.toString,at=ot.hasOwnProperty,st=RegExp("^"+it.call(at).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ct(t){return!(!C(t)||(e=t,Q&&Q in e))&&(X(t)?st:rt).test(et(t));var e}function ut(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return ct(r)?r:void 0}var ft=ut(j,"WeakMap"),lt=ft&&new ft,ht=lt?function(t,e){return lt.set(t,e),t}:Y,pt=Object.create,dt=function(){function t(){}return function(e){if(!C(e))return{};if(pt)return pt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function yt(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=dt(t.prototype),n=t.apply(r,e);return C(n)?n:r}}function vt(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var bt=Math.max;function gt(t,e,r,n){for(var o=-1,i=t.length,a=r.length,s=-1,c=e.length,u=bt(i-a,0),f=Array(c+u),l=!n;++s<c;)f[s]=e[s];for(;++o<a;)(l||o<i)&&(f[r[o]]=t[o]);for(;u--;)f[s++]=t[o++];return f}var mt=Math.max;function _t(t,e,r,n){for(var o=-1,i=t.length,a=-1,s=r.length,c=-1,u=e.length,f=mt(i-s,0),l=Array(f+u),h=!n;++o<f;)l[o]=t[o];for(var p=o;++c<u;)l[p+c]=e[c];for(;++a<s;)(h||o<i)&&(l[p+r[a]]=t[o++]);return l}function wt(){}function jt(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}jt.prototype=dt(wt.prototype),jt.prototype.constructor=jt;var Ot=lt?function(t){return lt.get(t)}:function(){},Et={},At=Object.prototype.hasOwnProperty;function xt(t){for(var e=t.name+"",r=Et[e],n=At.call(Et,e)?r.length:0;n--;){var o=r[n],i=o.func;if(null==i||i==t)return o.name}return e}function Tt(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function Pt(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}Tt.prototype=dt(wt.prototype),Tt.prototype.constructor=Tt;var St=Object.prototype.hasOwnProperty;function It(t){if(B(t)&&!k(t)&&!(t instanceof jt)){if(t instanceof Tt)return t;if(St.call(t,"__wrapped__"))return function(t){if(t instanceof jt)return t.clone();var e=new Tt(t.__wrapped__,t.__chain__);return e.__actions__=Pt(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}(t)}return new Tt(t)}function Bt(t){var e=xt(t),r=It[e];if("function"!=typeof r||!(e in jt.prototype))return!1;if(t===r)return!0;var n=Ot(r);return!!n&&t===n[0]}It.prototype=wt.prototype,It.prototype.constructor=It;var Nt=Date.now;function $t(t){var e=0,r=0;return function(){var n=Nt(),o=16-(n-r);if(r=n,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var kt=$t(ht),Rt=/\{\n\/\* \[wrapped with (.+)\] \*/,Lt=/,? & /;var Dt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;var Mt=function(){try{var t=ut(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Ft=Mt?function(t,e){return Mt(t,"toString",{configurable:!0,enumerable:!1,value:(r=e,function(){return r}),writable:!0});var r}:Y,Ut=$t(Ft);function Ct(t,e,r,n){for(var o=t.length,i=r+-1;++i<o;)if(e(t[i],i,t))return i;return-1}function Ht(t){return t!=t}function zt(t,e){return!!(null==t?0:t.length)&&function(t,e,r){return e==e?function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}(t,e,r):Ct(t,Ht,r)}(t,e,0)>-1}var qt=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];function Gt(t,e,r){var n=e+"";return Ut(t,function(t,e){var r=e.length;if(!r)return t;var n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(Dt,"{\n/* [wrapped with "+e+"] */\n")}(n,function(t,e){return function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););}(qt,(function(r){var n="_."+r[0];e&r[1]&&!zt(t,n)&&t.push(n)})),t.sort()}(function(t){var e=t.match(Rt);return e?e[1].split(Lt):[]}(n),r)))}function Wt(t,e,r,n,o,i,a,s,c,u){var f=8&e;e|=f?32:64,4&(e&=~(f?64:32))||(e&=-4);var l=[t,e,o,f?i:void 0,f?a:void 0,f?void 0:i,f?void 0:a,s,c,u],h=r.apply(void 0,l);return Bt(t)&&kt(h,l),h.placeholder=n,Gt(h,t,e)}function Jt(t){return t.placeholder}var Vt=/^(?:0|[1-9]\d*)$/;function Yt(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Vt.test(t))&&t>-1&&t%1==0&&t<e}var Xt=Math.min;var Zt="__lodash_placeholder__";function Kt(t,e){for(var r=-1,n=t.length,o=0,i=[];++r<n;){var a=t[r];a!==e&&a!==Zt||(t[r]=Zt,i[o++]=r)}return i}function Qt(t,e,r,n,o,i,a,s,c,u){var f=128&e,l=1&e,h=2&e,p=24&e,d=512&e,y=h?void 0:yt(t);return function v(){for(var b=arguments.length,g=Array(b),m=b;m--;)g[m]=arguments[m];if(p)var _=Jt(v),w=function(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&++n;return n}(g,_);if(n&&(g=gt(g,n,o,p)),i&&(g=_t(g,i,a,p)),b-=w,p&&b<u){var O=Kt(g,_);return Wt(t,e,Qt,v.placeholder,r,g,O,s,c,u-b)}var E=l?r:this,A=h?E[t]:t;return b=g.length,s?g=function(t,e){for(var r=t.length,n=Xt(e.length,r),o=Pt(t);n--;){var i=e[n];t[n]=Yt(i,r)?o[i]:void 0}return t}(g,s):d&&b>1&&g.reverse(),f&&c<b&&(g.length=c),this&&this!==j&&this instanceof v&&(A=y||yt(A)),A.apply(E,g)}}var te="__lodash_placeholder__",ee=128,re=Math.min;var ne=Math.max;function oe(t,e,r,n,o,i,a,s){var c=2&e;if(!c&&"function"!=typeof t)throw new TypeError("Expected a function");var u=n?n.length:0;if(u||(e&=-97,n=o=void 0),a=void 0===a?a:ne(V(a),0),s=void 0===s?s:V(s),u-=o?o.length:0,64&e){var f=n,l=o;n=o=void 0}var h=c?void 0:Ot(t),p=[t,e,r,n,o,f,l,i,a,s];if(h&&function(t,e){var r=t[1],n=e[1],o=r|n,i=o<131,a=n==ee&&8==r||n==ee&&256==r&&t[7].length<=e[8]||384==n&&e[7].length<=e[8]&&8==r;if(!i&&!a)return t;1&n&&(t[2]=e[2],o|=1&r?0:4);var s=e[3];if(s){var c=t[3];t[3]=c?gt(c,s,e[4]):s,t[4]=c?Kt(t[3],te):e[4]}(s=e[5])&&(c=t[5],t[5]=c?_t(c,s,e[6]):s,t[6]=c?Kt(t[5],te):e[6]),(s=e[7])&&(t[7]=s),n&ee&&(t[8]=null==t[8]?e[8]:re(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=o}(p,h),t=p[0],e=p[1],r=p[2],n=p[3],o=p[4],!(s=p[9]=void 0===p[9]?c?0:t.length:ne(p[9]-u,0))&&24&e&&(e&=-25),e&&1!=e)d=8==e||16==e?function(t,e,r){var n=yt(t);return function o(){for(var i=arguments.length,a=Array(i),s=i,c=Jt(o);s--;)a[s]=arguments[s];var u=i<3&&a[0]!==c&&a[i-1]!==c?[]:Kt(a,c);return(i-=u.length)<r?Wt(t,e,Qt,o.placeholder,void 0,a,u,void 0,void 0,r-i):vt(this&&this!==j&&this instanceof o?n:t,this,a)}}(t,e,s):32!=e&&33!=e||o.length?Qt.apply(void 0,p):function(t,e,r,n){var o=1&e,i=yt(t);return function e(){for(var a=-1,s=arguments.length,c=-1,u=n.length,f=Array(u+s),l=this&&this!==j&&this instanceof e?i:t;++c<u;)f[c]=n[c];for(;s--;)f[c++]=arguments[++a];return vt(l,o?r:this,f)}}(t,e,r,n);else var d=function(t,e,r){var n=1&e,o=yt(t);return function e(){return(this&&this!==j&&this instanceof e?o:t).apply(n?r:this,arguments)}}(t,e,r);return Gt((h?ht:kt)(d,p),t,e)}function ie(t,e,r){"__proto__"==e&&Mt?Mt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function ae(t,e){return t===e||t!=t&&e!=e}var se=Object.prototype.hasOwnProperty;function ce(t,e,r){var n=t[e];se.call(t,e)&&ae(n,r)&&(void 0!==r||e in t)||ie(t,e,r)}var ue=Math.max;function fe(t,e,r){return e=ue(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=ue(n.length-e,0),a=Array(i);++o<i;)a[o]=n[e+o];o=-1;for(var s=Array(e+1);++o<e;)s[o]=n[o];return s[e]=r(a),vt(t,this,s)}}function le(t,e){return Ut(fe(t,e,Y),t+"")}function he(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function pe(t){return null!=t&&he(t.length)&&!X(t)}var de=Object.prototype;function ye(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||de)}function ve(t){return B(t)&&"[object Arguments]"==I(t)}var be=Object.prototype,ge=be.hasOwnProperty,me=be.propertyIsEnumerable,_e=ve(function(){return arguments}())?ve:function(t){return B(t)&&ge.call(t,"callee")&&!me.call(t,"callee")};var we="object"==typeof exports&&exports&&!exports.nodeType&&exports,je=we&&"object"==typeof module&&module&&!module.nodeType&&module,Oe=je&&je.exports===we?j.Buffer:void 0,Ee=(Oe?Oe.isBuffer:void 0)||function(){return!1},Ae={};Ae["[object Float32Array]"]=Ae["[object Float64Array]"]=Ae["[object Int8Array]"]=Ae["[object Int16Array]"]=Ae["[object Int32Array]"]=Ae["[object Uint8Array]"]=Ae["[object Uint8ClampedArray]"]=Ae["[object Uint16Array]"]=Ae["[object Uint32Array]"]=!0,Ae["[object Arguments]"]=Ae["[object Array]"]=Ae["[object ArrayBuffer]"]=Ae["[object Boolean]"]=Ae["[object DataView]"]=Ae["[object Date]"]=Ae["[object Error]"]=Ae["[object Function]"]=Ae["[object Map]"]=Ae["[object Number]"]=Ae["[object Object]"]=Ae["[object RegExp]"]=Ae["[object Set]"]=Ae["[object String]"]=Ae["[object WeakMap]"]=!1;var xe,Te="object"==typeof exports&&exports&&!exports.nodeType&&exports,Pe=Te&&"object"==typeof module&&module&&!module.nodeType&&module,Se=Pe&&Pe.exports===Te&&_.process,Ie=function(){try{var t=Pe&&Pe.require&&Pe.require("util").types;return t||Se&&Se.binding&&Se.binding("util")}catch(t){}}(),Be=Ie&&Ie.isTypedArray,Ne=Be?(xe=Be,function(t){return xe(t)}):function(t){return B(t)&&he(t.length)&&!!Ae[I(t)]},$e=Object.prototype.hasOwnProperty;function ke(t,e){var r=k(t),n=!r&&_e(t),o=!r&&!n&&Ee(t),i=!r&&!n&&!o&&Ne(t),a=r||n||o||i,s=a?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],c=s.length;for(var u in t)!e&&!$e.call(t,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Yt(u,c))||s.push(u);return s}function Re(t,e){return function(r){return t(e(r))}}var Le=Re(Object.keys,Object),De=Object.prototype.hasOwnProperty;function Me(t){return pe(t)?ke(t):function(t){if(!ye(t))return Le(t);var e=[];for(var r in Object(t))De.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}var Fe=Object.prototype.hasOwnProperty;function Ue(t){if(!C(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=ye(t),r=[];for(var n in t)("constructor"!=n||!e&&Fe.call(t,n))&&r.push(n);return r}var Ce,He=(Ce=function(t,e){!function(t,e,r){var n=!r;r||(r={});for(var o=-1,i=e.length;++o<i;){var a=e[o],s=void 0;void 0===s&&(s=t[a]),n?ie(r,a,s):ce(r,a,s)}}(e,function(t){return pe(t)?ke(t,!0):Ue(t)}(e),t)},le((function(t,e){var r=-1,n=e.length,o=n>1?e[n-1]:void 0,i=n>2?e[2]:void 0;for(o=Ce.length>3&&"function"==typeof o?(n--,o):void 0,i&&function(t,e,r){if(!C(r))return!1;var n=typeof e;return!!("number"==n?pe(r)&&Yt(e,r.length):"string"==n&&e in r)&&ae(r[e],t)}(e[0],e[1],i)&&(o=n<3?void 0:o,n=1),t=Object(t);++r<n;){var a=e[r];a&&Ce(t,a,r,o)}return t}))),ze=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,qe=/^\w*$/;function Ge(t,e){if(k(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!N(t))||(qe.test(t)||!ze.test(t)||null!=e&&t in Object(e))}var We=ut(Object,"create");var Je=Object.prototype.hasOwnProperty;var Ve=Object.prototype.hasOwnProperty;function Ye(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Xe(t,e){for(var r=t.length;r--;)if(ae(t[r][0],e))return r;return-1}Ye.prototype.clear=function(){this.__data__=We?We(null):{},this.size=0},Ye.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Ye.prototype.get=function(t){var e=this.__data__;if(We){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return Je.call(e,t)?e[t]:void 0},Ye.prototype.has=function(t){var e=this.__data__;return We?void 0!==e[t]:Ve.call(e,t)},Ye.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=We&&void 0===e?"__lodash_hash_undefined__":e,this};var Ze=Array.prototype.splice;function Ke(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ke.prototype.clear=function(){this.__data__=[],this.size=0},Ke.prototype.delete=function(t){var e=this.__data__,r=Xe(e,t);return!(r<0)&&(r==e.length-1?e.pop():Ze.call(e,r,1),--this.size,!0)},Ke.prototype.get=function(t){var e=this.__data__,r=Xe(e,t);return r<0?void 0:e[r][1]},Ke.prototype.has=function(t){return Xe(this.__data__,t)>-1},Ke.prototype.set=function(t,e){var r=this.__data__,n=Xe(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var Qe=ut(j,"Map");function tr(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function er(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}er.prototype.clear=function(){this.size=0,this.__data__={hash:new Ye,map:new(Qe||Ke),string:new Ye}},er.prototype.delete=function(t){var e=tr(this,t).delete(t);return this.size-=e?1:0,e},er.prototype.get=function(t){return tr(this,t).get(t)},er.prototype.has=function(t){return tr(this,t).has(t)},er.prototype.set=function(t,e){var r=tr(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function rr(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(rr.Cache||er),r}rr.Cache=er;var nr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,or=/\\(\\)?/g,ir=function(t){var e=rr(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(nr,(function(t,r,n,o){e.push(n?o.replace(or,"$1"):r||t)})),e}));function ar(t,e){return k(t)?t:Ge(t,e)?[t]:ir(function(t){return null==t?"":D(t)}(t))}function sr(t){if("string"==typeof t||N(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function cr(t,e){for(var r=0,n=(e=ar(e,t)).length;null!=t&&r<n;)t=t[sr(e[r++])];return r&&r==n?t:void 0}function ur(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}var fr=O?O.isConcatSpreadable:void 0;function lr(t){return k(t)||_e(t)||!!(fr&&t&&t[fr])}function hr(t,e,r,n,o){var i=-1,a=t.length;for(r||(r=lr),o||(o=[]);++i<a;){var s=t[i];r(s)?ur(o,s):o[o.length]=s}return o}function pr(t){return(null==t?0:t.length)?hr(t):[]}var dr=Re(Object.getPrototypeOf,Object),yr=Function.prototype,vr=Object.prototype,br=yr.toString,gr=vr.hasOwnProperty,mr=br.call(Object);function _r(t){if(!B(t))return!1;var e=I(t);return"[object Error]"==e||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!function(t){if(!B(t)||"[object Object]"!=I(t))return!1;var e=dr(t);if(null===e)return!0;var r=gr.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&br.call(r)==mr}(t)}var wr=le((function(t,e){try{return vt(t,void 0,e)}catch(t){return _r(t)?t:new Error(t)}}));function jr(t,e,r,n){var o=-1,i=null==t?0:t.length;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}function Or(t){var e=this.__data__=new Ke(t);this.size=e.size}function Er(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var a=t[r];e(a,r,t)&&(i[o++]=a)}return i}Or.prototype.clear=function(){this.__data__=new Ke,this.size=0},Or.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Or.prototype.get=function(t){return this.__data__.get(t)},Or.prototype.has=function(t){return this.__data__.has(t)},Or.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Ke){var n=r.__data__;if(!Qe||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new er(n)}return r.set(t,e),this.size=r.size,this};var Ar=Object.prototype.propertyIsEnumerable,xr=Object.getOwnPropertySymbols,Tr=xr?function(t){return null==t?[]:(t=Object(t),Er(xr(t),(function(e){return Ar.call(t,e)})))}:function(){return[]};function Pr(t){return function(t,e,r){var n=e(t);return k(t)?n:ur(n,r(t))}(t,Me,Tr)}var Sr=ut(j,"DataView"),Ir=ut(j,"Promise"),Br=ut(j,"Set"),Nr="[object Map]",$r="[object Promise]",kr="[object Set]",Rr="[object WeakMap]",Lr="[object DataView]",Dr=et(Sr),Mr=et(Qe),Fr=et(Ir),Ur=et(Br),Cr=et(ft),Hr=I;(Sr&&Hr(new Sr(new ArrayBuffer(1)))!=Lr||Qe&&Hr(new Qe)!=Nr||Ir&&Hr(Ir.resolve())!=$r||Br&&Hr(new Br)!=kr||ft&&Hr(new ft)!=Rr)&&(Hr=function(t){var e=I(t),r="[object Object]"==e?t.constructor:void 0,n=r?et(r):"";if(n)switch(n){case Dr:return Lr;case Mr:return Nr;case Fr:return $r;case Ur:return kr;case Cr:return Rr}return e});var zr=j.Uint8Array;function qr(t){for(var e=-1,r=null==t?0:t.length,n=0,o=[];++e<r;){var i=t[e];i&&(o[n++]=i)}return o}function Gr(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new er;++e<r;)this.add(t[e])}function Wr(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}Gr.prototype.add=Gr.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Gr.prototype.has=function(t){return this.__data__.has(t)};function Jr(t,e,r,n,o,i){var a=1&r,s=t.length,c=e.length;if(s!=c&&!(a&&c>s))return!1;var u=i.get(t),f=i.get(e);if(u&&f)return u==e&&f==t;var l=-1,h=!0,p=2&r?new Gr:void 0;for(i.set(t,e),i.set(e,t);++l<s;){var d=t[l],y=e[l];if(n)var v=a?n(y,d,l,e,t,i):n(d,y,l,t,e,i);if(void 0!==v){if(v)continue;h=!1;break}if(p){if(!Wr(e,(function(t,e){if(a=e,!p.has(a)&&(d===t||o(d,t,r,n,i)))return p.push(e);var a}))){h=!1;break}}else if(d!==y&&!o(d,y,r,n,i)){h=!1;break}}return i.delete(t),i.delete(e),h}function Vr(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function Yr(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var Xr=O?O.prototype:void 0,Zr=Xr?Xr.valueOf:void 0;var Kr=Object.prototype.hasOwnProperty;var Qr="[object Arguments]",tn="[object Array]",en="[object Object]",rn=Object.prototype.hasOwnProperty;function nn(t,e,r,n,o,i){var a=k(t),s=k(e),c=a?tn:Hr(t),u=s?tn:Hr(e),f=(c=c==Qr?en:c)==en,l=(u=u==Qr?en:u)==en,h=c==u;if(h&&Ee(t)){if(!Ee(e))return!1;a=!0,f=!1}if(h&&!f)return i||(i=new Or),a||Ne(t)?Jr(t,e,r,n,o,i):function(t,e,r,n,o,i,a){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!i(new zr(t),new zr(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ae(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=Vr;case"[object Set]":var c=1&n;if(s||(s=Yr),t.size!=e.size&&!c)return!1;var u=a.get(t);if(u)return u==e;n|=2,a.set(t,e);var f=Jr(s(t),s(e),n,o,i,a);return a.delete(t),f;case"[object Symbol]":if(Zr)return Zr.call(t)==Zr.call(e)}return!1}(t,e,c,r,n,o,i);if(!(1&r)){var p=f&&rn.call(t,"__wrapped__"),d=l&&rn.call(e,"__wrapped__");if(p||d){var y=p?t.value():t,v=d?e.value():e;return i||(i=new Or),o(y,v,r,n,i)}}return!!h&&(i||(i=new Or),function(t,e,r,n,o,i){var a=1&r,s=Pr(t),c=s.length;if(c!=Pr(e).length&&!a)return!1;for(var u=c;u--;){var f=s[u];if(!(a?f in e:Kr.call(e,f)))return!1}var l=i.get(t),h=i.get(e);if(l&&h)return l==e&&h==t;var p=!0;i.set(t,e),i.set(e,t);for(var d=a;++u<c;){var y=t[f=s[u]],v=e[f];if(n)var b=a?n(v,y,f,e,t,i):n(y,v,f,t,e,i);if(!(void 0===b?y===v||o(y,v,r,n,i):b)){p=!1;break}d||(d="constructor"==f)}if(p&&!d){var g=t.constructor,m=e.constructor;g==m||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m||(p=!1)}return i.delete(t),i.delete(e),p}(t,e,r,n,o,i))}function on(t,e,r,n,o){return t===e||(null==t||null==e||!B(t)&&!B(e)?t!=t&&e!=e:nn(t,e,r,n,on,o))}function an(t){return t==t&&!C(t)}function sn(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}function cn(t){var e=function(t){for(var e=Me(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,an(o)]}return e}(t);return 1==e.length&&e[0][2]?sn(e[0][0],e[0][1]):function(r){return r===t||function(t,e,r,n){var o=r.length,i=o;if(null==t)return!i;for(t=Object(t);o--;){var a=r[o];if(a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var s=(a=r[o])[0],c=t[s],u=a[1];if(a[2]){if(void 0===c&&!(s in t))return!1}else if(!on(u,c,3,n,new Or))return!1}return!0}(r,0,e)}}function un(t,e){return null!=t&&e in Object(t)}function fn(t,e){return null!=t&&function(t,e,r){for(var n=-1,o=(e=ar(e,t)).length,i=!1;++n<o;){var a=sr(e[n]);if(!(i=null!=t&&r(t,a)))break;t=t[a]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&he(o)&&Yt(a,o)&&(k(t)||_e(t))}(t,e,un)}function ln(t,e){return Ge(t)&&an(e)?sn(sr(t),e):function(r){var n=function(t,e,r){var n=null==t?void 0:cr(t,e);return void 0===n?r:n}(r,t);return void 0===n&&n===e?fn(r,t):on(e,n,3)}}function hn(t){return Ge(t)?(e=sr(t),function(t){return null==t?void 0:t[e]}):function(t){return function(e){return cr(e,t)}}(t);var e}function pn(t){return"function"==typeof t?t:null==t?Y:"object"==typeof t?k(t)?ln(t[0],t[1]):cn(t):hn(t)}function dn(t,e,r,n){for(var o=-1,i=null==t?0:t.length;++o<i;){var a=t[o];e(n,a,r(a),t)}return n}var yn=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),a=i.length;a--;){var s=i[++n];if(!1===e(o[s],s,o))break}return t};function vn(t,e){return t&&yn(t,e,Me)}var bn,gn=(bn=vn,function(t,e){if(null==t)return t;if(!pe(t))return bn(t,e);for(var r=t.length,n=-1,o=Object(t);++n<r&&!1!==e(o[n],n,o););return t});function mn(t,e,r,n){return gn(t,(function(t,o,i){e(n,t,r(t),i)})),n}function _n(t,e){var r=[];return gn(t,(function(t,n,o){e(t,n,o)&&r.push(t)})),r}function wn(t,e){return(k(t)?Er:_n)(t,pn(e))}var jn=Math.max;var On,En=(On=function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var o=null==r?0:V(r);return o<0&&(o=jn(n+o,0)),Ct(t,pn(e),o)},function(t,e,r){var n=Object(t);if(!pe(t)){var o=pn(e);t=Me(t),e=function(t){return o(n[t],t,n)}}var i=On(t,e,r);return i>-1?n[o?t[i]:i]:void 0});function An(t,e){var r=-1,n=pe(t)?Array(t.length):[];return gn(t,(function(t,o,i){n[++r]=e(t,o,i)})),n}function xn(t,e){return(k(t)?$:An)(t,pn(e))}function Tn(t,e){return hr(xn(t,e))}var Pn,Sn=function(t){return Ut(fe(t,void 0,pr),t+"")}((function(t){for(var e=t.length,r=e,n=Tt.prototype.thru;r--;){var o=t[r];if("function"!=typeof o)throw new TypeError("Expected a function");if(n&&!i&&"wrapper"==xt(o))var i=new Tt([],!0)}for(r=i?r:e;++r<e;){var a=xt(o=t[r]),s="wrapper"==a?Ot(o):void 0;i=s&&Bt(s[0])&&424==s[1]&&!s[4].length&&1==s[9]?i[xt(s[0])].apply(i,s[3]):1==o.length&&Bt(o)?i[a]():i.thru(o)}return function(){var r=arguments,n=r[0];if(i&&1==r.length&&k(n))return i.plant(n).value();for(var o=0,a=e?t[o].apply(this,r):n;++o<e;)a=t[o].call(this,a);return a}})),In=Object.prototype.hasOwnProperty,Bn=(Pn=function(t,e,r){In.call(t,r)?t[r].push(e):ie(t,r,[e])},function(t,e){return(k(t)?dn:mn)(t,Pn,pn(e),{})});function Nn(t){return null==t?[]:function(t,e){return $(e,(function(e){return t[e]}))}(t,Me(t))}var $n=Array.prototype.join;function kn(t,e){var r={};return e=pn(e),vn(t,(function(t,n,o){ie(r,n,e(t,n,o))})),r}var Rn=le((function(t,e){return oe(t,64,void 0,e,Kt(e,Jt(Rn)))}));function Ln(t,e,r,n,o){return o(t,(function(t,o,i){r=n?(n=!1,t):e(r,t,o,i)})),r}function Dn(t,e,r){var n=k(t)?jr:Ln,o=arguments.length<3;return n(t,pn(e),r,o,gn)}Rn.placeholder={};var Mn="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{},Fn="URLSearchParams"in Mn,Un="Symbol"in Mn&&"iterator"in Symbol,Cn="FileReader"in Mn&&"Blob"in Mn&&function(){try{return new Blob,!0}catch(t){return!1}}(),Hn="FormData"in Mn,zn="ArrayBuffer"in Mn;if(zn)var qn=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Gn=ArrayBuffer.isView||function(t){return t&&qn.indexOf(Object.prototype.toString.call(t))>-1};function Wn(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function Jn(t){return"string"!=typeof t&&(t=String(t)),t}function Vn(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return Un&&(e[Symbol.iterator]=function(){return e}),e}function Yn(t){this.map={},t instanceof Yn?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){if(2!=t.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+t.length);this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function Xn(t){if(!t._noBody)return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function Zn(t){return new Promise((function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}}))}function Kn(t){var e=new FileReader,r=Zn(e);return e.readAsArrayBuffer(t),r}function Qn(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function to(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:Cn&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:Hn&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:Fn&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():zn&&Cn&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=Qn(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):zn&&(ArrayBuffer.prototype.isPrototypeOf(t)||Gn(t))?this._bodyArrayBuffer=Qn(t):this._bodyText=t=Object.prototype.toString.call(t):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):Fn&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},Cn&&(this.blob=function(){var t=Xn(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=Xn(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}if(Cn)return this.blob().then(Kn);throw new Error("could not read as ArrayBuffer")},this.text=function(){var t,e,r,n,o,i=Xn(this);if(i)return i;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,r=Zn(e),n=/charset=([A-Za-z0-9_-]+)/.exec(t.type),o=n?n[1]:"utf-8",e.readAsText(t,o),r;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},Hn&&(this.formData=function(){return this.text().then(no)}),this.json=function(){return this.text().then(JSON.parse)},this}Yn.prototype.append=function(t,e){t=Wn(t),e=Jn(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},Yn.prototype.delete=function(t){delete this.map[Wn(t)]},Yn.prototype.get=function(t){return t=Wn(t),this.has(t)?this.map[t]:null},Yn.prototype.has=function(t){return this.map.hasOwnProperty(Wn(t))},Yn.prototype.set=function(t,e){this.map[Wn(t)]=Jn(e)},Yn.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},Yn.prototype.keys=function(){var t=[];return this.forEach((function(e,r){t.push(r)})),Vn(t)},Yn.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),Vn(t)},Yn.prototype.entries=function(){var t=[];return this.forEach((function(e,r){t.push([r,e])})),Vn(t)},Un&&(Yn.prototype[Symbol.iterator]=Yn.prototype.entries);var eo=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function ro(t,e){if(!(this instanceof ro))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,n,o=(e=e||{}).body;if(t instanceof ro){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new Yn(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,o||null==t._bodyInit||(o=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new Yn(e.headers)),this.method=(r=e.method||this.method||"GET",n=r.toUpperCase(),eo.indexOf(n)>-1?n:r),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in Mn)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache)){var i=/([?&])_=[^&]*/;if(i.test(this.url))this.url=this.url.replace(i,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function no(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(o))}})),e}function oo(t,e){if(!(this instanceof oo))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===e.statusText?"":""+e.statusText,this.headers=new Yn(e.headers),this.url=e.url||"",this._initBody(t)}ro.prototype.clone=function(){return new ro(this,{body:this._bodyInit})},to.call(ro.prototype),to.call(oo.prototype),oo.prototype.clone=function(){return new oo(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Yn(this.headers),url:this.url})},oo.error=function(){var t=new oo(null,{status:200,statusText:""});return t.ok=!1,t.status=0,t.type="error",t};var io=[301,302,303,307,308];oo.redirect=function(t,e){if(-1===io.indexOf(e))throw new RangeError("Invalid status code");return new oo(null,{status:e,headers:{location:t}})};var ao=Mn.DOMException;try{new ao}catch(t){(ao=function(t,e){this.message=t,this.name=e;var r=Error(t);this.stack=r.stack}).prototype=Object.create(Error.prototype),ao.prototype.constructor=ao}function so(t,e){return new Promise((function(r,n){var o=new ro(t,e);if(o.signal&&o.signal.aborted)return n(new ao("Aborted","AbortError"));var i=new XMLHttpRequest;function a(){i.abort()}if(i.onload=function(){var t,e,n={statusText:i.statusText,headers:(t=i.getAllResponseHeaders()||"",e=new Yn,t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var r=t.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();try{e.append(n,o)}catch(t){console.warn("Response "+t.message)}}})),e)};0===o.url.indexOf("file://")&&(i.status<200||i.status>599)?n.status=200:n.status=i.status,n.url="responseURL"in i?i.responseURL:n.headers.get("X-Request-URL");var a="response"in i?i.response:i.responseText;setTimeout((function(){r(new oo(a,n))}),0)},i.onerror=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},i.ontimeout=function(){setTimeout((function(){n(new TypeError("Network request timed out"))}),0)},i.onabort=function(){setTimeout((function(){n(new ao("Aborted","AbortError"))}),0)},i.open(o.method,function(t){try{return""===t&&Mn.location.href?Mn.location.href:t}catch(e){return t}}(o.url),!0),"include"===o.credentials?i.withCredentials=!0:"omit"===o.credentials&&(i.withCredentials=!1),"responseType"in i&&(Cn?i.responseType="blob":zn&&(i.responseType="arraybuffer")),e&&"object"==typeof e.headers&&!(e.headers instanceof Yn||Mn.Headers&&e.headers instanceof Mn.Headers)){var s=[];Object.getOwnPropertyNames(e.headers).forEach((function(t){s.push(Wn(t)),i.setRequestHeader(t,Jn(e.headers[t]))})),o.headers.forEach((function(t,e){-1===s.indexOf(e)&&i.setRequestHeader(e,t)}))}else o.headers.forEach((function(t,e){i.setRequestHeader(e,t)}));o.signal&&(o.signal.addEventListener("abort",a),i.onreadystatechange=function(){4===i.readyState&&o.signal.removeEventListener("abort",a)}),i.send(void 0===o._bodyInit?null:o._bodyInit)}))}so.polyfill=!0,Mn.fetch||(Mn.fetch=so,Mn.Headers=Yn,Mn.Request=ro,Mn.Response=oo);var co=Object.defineProperty,uo=(t,e,r)=>(((t,e,r)=>{e in t?co(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r})(t,"symbol"!=typeof e?e+"":e,r),r);class fo extends Error{constructor(t,e){super(t),this.error=t,this.status_code=e,this.name="ResponseError",Error.captureStackTrace&&Error.captureStackTrace(this,fo)}}class lo{constructor(t,e,r){uo(this,"abortController"),uo(this,"itr"),uo(this,"doneCallback"),this.abortController=t,this.itr=e,this.doneCallback=r}abort(){this.abortController.abort()}async*[Symbol.asyncIterator](){for await(const t of this.itr){if("error"in t)throw new Error(t.error);if(yield t,t.done||"success"===t.status)return void this.doneCallback()}throw new Error("Did not receive done or success response in stream.")}}const ho=async t=>{if(t.ok)return;let e=`Error ${t.status}: ${t.statusText}`,r=null;if(t.headers.get("content-type")?.includes("application/json"))try{r=await t.json(),e=r.error||e}catch(t){console.log("Failed to parse error response as JSON")}else try{console.log("Getting text from response");e=await t.text()||e}catch(t){console.log("Failed to get text from error response")}throw new fo(e,t.status)};const po=async(t,e,r={})=>{const n={"Content-Type":"application/json",Accept:"application/json","User-Agent":`ollama-js/0.5.10 (${"undefined"!=typeof window&&window.navigator?`${window.navigator.platform.toLowerCase()} Browser/${navigator.userAgent};`:"undefined"!=typeof process?`${process.arch} ${process.platform} Node.js/${process.version}`:""})`};r.headers||(r.headers={});const o=Object.fromEntries(Object.entries(r.headers).filter((([t])=>!Object.keys(n).some((e=>e.toLowerCase()===t.toLowerCase())))));return r.headers={...n,...o},t(e,r)},yo=async(t,e,r)=>{const n=await po(t,e,{headers:r?.headers});return await ho(n),n},vo=async(t,e,r,n)=>{const o=null===(i=r)||"object"!=typeof i||Array.isArray(i)?r:JSON.stringify(r);var i;const a=await po(t,e,{method:"POST",body:o,signal:n?.signal,headers:n?.headers});return await ho(a),a};var bo=Object.defineProperty,go=(t,e,r)=>(((t,e,r)=>{e in t?bo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r})(t,"symbol"!=typeof e?e+"":e,r),r);let mo=class{constructor(t){go(this,"config"),go(this,"fetch"),go(this,"ongoingStreamedRequests",[]),this.config={host:"",headers:t?.headers},t?.proxy||(this.config.host=(t=>{if(!t)return"http://127.0.0.1:11434";let e=t.includes("://");t.startsWith(":")&&(t=`http://127.0.0.1${t}`,e=!0),e||(t=`http://${t}`);const r=new URL(t);let n=r.port;n||(n=e?"https:"===r.protocol?"443":"80":"11434");let o=`${r.protocol}//${r.hostname}:${n}${r.pathname}`;return o.endsWith("/")&&(o=o.slice(0,-1)),o})(t?.host??"http://127.0.0.1:11434")),this.fetch=t?.fetch??fetch}abort(){for(const t of this.ongoingStreamedRequests)t.abort();this.ongoingStreamedRequests.length=0}async processStreamableRequest(t,e){e.stream=e.stream??!1;const r=`${this.config.host}/api/${t}`;if(e.stream){const t=new AbortController,n=await vo(this.fetch,r,e,{signal:t.signal,headers:this.config.headers});if(!n.body)throw new Error("Missing body");const o=async function*(t){const e=new TextDecoder("utf-8");let r="";const n=t.getReader();for(;;){const{done:t,value:o}=await n.read();if(t)break;r+=e.decode(o);const i=r.split("\n");r=i.pop()??"";for(const t of i)try{yield JSON.parse(t)}catch(e){console.warn("invalid json: ",t)}}for(const t of r.split("\n").filter((t=>""!==t)))try{yield JSON.parse(t)}catch(e){console.warn("invalid json: ",t)}}(n.body),i=new lo(t,o,(()=>{const t=this.ongoingStreamedRequests.indexOf(i);t>-1&&this.ongoingStreamedRequests.splice(t,1)}));return this.ongoingStreamedRequests.push(i),i}const n=await vo(this.fetch,r,e,{headers:this.config.headers});return await n.json()}async encodeImage(t){if("string"!=typeof t){const e=new Uint8Array(t);let r="";const n=e.byteLength;for(let t=0;t<n;t++)r+=String.fromCharCode(e[t]);return btoa(r)}return t}async generate(t){return t.images&&(t.images=await Promise.all(t.images.map(this.encodeImage.bind(this)))),this.processStreamableRequest("generate",t)}async chat(t){if(t.messages)for(const e of t.messages)e.images&&(e.images=await Promise.all(e.images.map(this.encodeImage.bind(this))));return this.processStreamableRequest("chat",t)}async create(t){return this.processStreamableRequest("create",{name:t.model,stream:t.stream,modelfile:t.modelfile,quantize:t.quantize})}async pull(t){return this.processStreamableRequest("pull",{name:t.model,stream:t.stream,insecure:t.insecure})}async push(t){return this.processStreamableRequest("push",{name:t.model,stream:t.stream,insecure:t.insecure})}async delete(t){return await(async(t,e,r,n)=>{const o=await po(t,e,{method:"DELETE",body:JSON.stringify(r),headers:n?.headers});return await ho(o),o})(this.fetch,`${this.config.host}/api/delete`,{name:t.model},{headers:this.config.headers}),{status:"success"}}async copy(t){return await vo(this.fetch,`${this.config.host}/api/copy`,{...t},{headers:this.config.headers}),{status:"success"}}async list(){const t=await yo(this.fetch,`${this.config.host}/api/tags`,{headers:this.config.headers});return await t.json()}async show(t){const e=await vo(this.fetch,`${this.config.host}/api/show`,{...t},{headers:this.config.headers});return await e.json()}async embed(t){const e=await vo(this.fetch,`${this.config.host}/api/embed`,{...t},{headers:this.config.headers});return await e.json()}async embeddings(t){const e=await vo(this.fetch,`${this.config.host}/api/embeddings`,{...t},{headers:this.config.headers});return await e.json()}async ps(){const t=await yo(this.fetch,`${this.config.host}/api/ps`,{headers:this.config.headers});return await t.json()}};new mo;class _o extends mo{async encodeImage(t){if("string"!=typeof t)return Buffer.from(t).toString("base64");try{if(n.existsSync(t)){const e=await o.readFile(a(t));return Buffer.from(e).toString("base64")}}catch{}return t}async parseModelfile(t,e=process.cwd()){const r=[],n=t.split("\n");for(const t of n){const[n,o]=t.split(" ",2);if(["FROM","ADAPTER"].includes(n.toUpperCase())){const t=this.resolvePath(o.trim(),e);await this.fileExists(t)?r.push(`${n} @${await this.createBlob(t)}`):r.push(`${n} ${o}`)}else r.push(t)}return r.join("\n")}resolvePath(t,e){return t.startsWith("~")?s(f(),t.slice(1)):a(e,t)}async fileExists(t){try{return await o.access(t),!0}catch{return!1}}async createBlob(t){if("undefined"==typeof ReadableStream)throw new Error("Streaming uploads are not supported in this environment.");const e=i(t),r=`sha256:${await new Promise(((t,r)=>{const n=u("sha256");e.on("data",(t=>n.update(t))),e.on("end",(()=>t(n.digest("hex")))),e.on("error",r)}))}`;try{await(async(t,e)=>{const r=await po(t,e,{method:"HEAD"});return await ho(r),r})(this.fetch,`${this.config.host}/api/blobs/${r}`)}catch(t){if(!(t instanceof Error&&t.message.includes("404")))throw t;{const t=new ReadableStream({start(t){e.on("data",(e=>{t.enqueue(e)})),e.on("end",(()=>{t.close()})),e.on("error",(e=>{t.error(e)}))}});await vo(this.fetch,`${this.config.host}/api/blobs/${r}`,t)}}return r}async create(t){let e="";if(t.path)e=await o.readFile(t.path,{encoding:"utf8"}),e=await this.parseModelfile(e,c(t.path));else{if(!t.modelfile)throw new Error("Must provide either path or modelfile to create a model");e=await this.parseModelfile(t.modelfile)}return t.modelfile=e,t.stream,super.create(t)}}const wo=new _o;class jo{static getDiffByLineMap(t){return Dn(t,((t,e)=>{const r=Sn([qr,Rn(Tn,(t=>t.changes)),Rn(wn,(({type:t})=>"insert"===t||"delete"===t)),Rn(Bn,hn("lineNumber")),Nn])(e.hunks);return He(t,{[e.newPath]:r})}),{})}static getLineDiffProcessed(t){switch(t.length){case 1:const{type:e,lineNumber:r,content:n}=t[0];return`${this.changeTypeToTextMap[e]} content: ${n} at line ${r}`;case 2:const o=En(t,(t=>"insert"===t.type)),i=En(t,(t=>"delete"===t.type));return o&&i?`Replace content: ${o.content} with ${i.content} at line ${o.lineNumber}`:"";default:return""}}}var Oo;jo.changeTypeToTextMap={delete:"Deleted",insert:"Added",normal:"Not changed"},function(t){t.NONE="NONE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"}(Oo||(Oo={}));const Eo={[Oo.HIGH]:[Oo.HIGH],[Oo.MEDIUM]:[Oo.MEDIUM,Oo.HIGH],[Oo.LOW]:[Oo.LOW,Oo.MEDIUM,Oo.HIGH],[Oo.NONE]:[Oo.NONE,Oo.LOW,Oo.MEDIUM,Oo.HIGH]},Ao={role:"assistant",content:'\n\t\tYou are a code reviewer tasked with analyzing a diff for potentially malicious code injections, backdoors, or other security vulnerabilities.  You will receive a diff representing changes made to a file.  Your goal is to identify suspicious patterns and assess the risk they pose.\n\t\t\n\t\tFocus your analysis on the following potential security issues:\n\t\t\n\t\t* **Code Injection:** Look for the introduction of unsanitized user inputs into executable contexts (e.g., SQL queries, command execution, script evaluation).\n\t\t* **Backdoors:** Identify any code that could allow unauthorized access or control, such as hardcoded credentials, hidden accounts, or undocumented remote access capabilities.\n\t\t* **Trojans/Malware:** Detect code designed to perform malicious actions, such as data exfiltration, system disruption, or propagation to other systems.\n\t\t* **Logic Bombs:** Look for code designed to trigger malicious actions under specific conditions or after a certain time delay.\n\t\t* **Privilege Escalation:** Identify attempts to gain higher-level system privileges without proper authorization.\n\t\t\n\t\tYour response should be a JSON object. If you detect potentially malicious changes, return (IN FORMAT AVAILABLE FOR JSON.parse(...)):\n\n\t\t{"reason": "<A DETAILED EXPLANATION OF THE SUSPICIOUS CHANGE, INCLUDING THE TYPE OF VULNERABILITY (e.g., Code Injection), THE LOCATION IN THE DIFF, AND THE POTENTIAL IMPACT>","severity": "<NONE, LOW, MEDIUM, or HIGH based on the potential impact of the vulnerability>"}'};class xo{constructor(t,e){this.model=t,this.ollama=e}sendRequestFile(t){return l(this,void 0,void 0,(function*(){return this.ollama.chat({model:this.model,messages:[Ao,{role:"user",content:t}],options:{num_ctx:2*t.length}})}))}}class To{exec(n){return l(this,arguments,void 0,(function*(n,o=!1,i=Oo.HIGH){const a=r("git rev-parse --show-toplevel").toString().trim(),s=yield wo.list();if(!En(s.models,(t=>t.name===n)))throw new Error(`Couldn't find local model: ${n}`);const c=r("git diff"),u=m.parse(c.toString()),f=jo.getDiffByLineMap(u),h=Sn(Rn(kn,(t=>xn(t,(t=>jo.getLineDiffProcessed(t))))),Rn(Dn,((r,n,o)=>{return r.concat([{content:(i=[`Filename: ${o}`,`Content: ${t.readFileSync(e.join(a,o))}`,...n],s="\n",null==i?"":$n.call(i,s)),fileName:o}]);var i,s}),[]))(f),p=new xo(n,new _o),d=o?Promise.all.bind(Promise):Promise.allSettled.bind(Promise),y=wn(yield d(xn(h,(({content:t,fileName:e})=>new Promise(((r,n)=>l(this,void 0,void 0,(function*(){const a=(yield p.sendRequestFile(t)).message.content;o&&console.log(a);const s=wr(JSON.parse,a.substring(7,a.length-3));s instanceof Error&&(console.error("Received broken response from ollama service."),process.exit(1));var c;(c=s.severity,Eo[i].includes(c))&&n({json:s,fileName:e}),r(void 0)}))))))),(t=>"rejected"===t.status)).map((t=>t.reason));0===y.length?process.exit(0):(y.forEach((t=>{console.log(`${t.fileName}: ${t.json.reason}\n`)})),process.exit(1))}))}}!function(){l(this,void 0,void 0,(function*(){const t=new To;try{const e=b(process.argv.slice(2));yield t.exec(e.model);process.exit(0)}catch(t){console.error(t),process.exit(1)}}))}();
